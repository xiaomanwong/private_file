# QUIC



> 新一代 HTTP 请求方案

互联网的快速发展，基础网络环境也在变化，web 网络协议同样经历了 HTTP 1.0/1.1， HTTP 2.0 以及未来的 HTTP 3.0。HTTP 3.0 将会用 QUIC 协议替代 TCP 作为传输层，具备 stream 多路复用，握手 0RTT，链接迁移以及用户态拥塞算法诸多优势。

| HTTP1.0 | HTTP 1.1                                                     | HTTP S                                                       | HTTP2.0                                            | HTTP3.0                                             |
| ------- | ------------------------------------------------------------ | ------------------------------------------------------------ | -------------------------------------------------- | --------------------------------------------------- |
|         | 支持长连接，请求 pipeline 特性，听过减少 TCP 三次握手，降低链接建立的开销 | 增加 TLS 层握手，传输内容加解密，因增加安全特性，故增加建联延时 | 请求数据流的多路复用和头部压缩，提高单链的并发能力 | udp 传输，具备 HTTP2.0 的特性，还具备链接迁移能力。 |

## QUIC 解决了哪些问题

### 1. 低连接延时

QUIC 基于 UDP ，无需 TCP 连接，最好情况下，QUIC 可以做到 0RTT 开启数据传输，基于 TCP 的 HTTPS ，即使在 TLS 1.3 的 early data 下仍然需要 1RTT 开启数据传输。然而对于常见的 TLS1.2 完全握手的情况，则需要 3RTT 开始数据传输。

### 2. 无对头阻塞

HTTP2.0 实现了多路复用，但是传输层依然使用的是 TCP，一旦出现某个报文丢失，将会影响多路复用下的所有请求流。QUIC 使用 UDP，设计上解决了队头阻塞问题。同时 HTTP3 使用 QPACK 编码替换 HPACK 编码，在一定程度上减轻了 HTTP 请求头的队头阻塞问题。

### 3. 用户态拥塞控制

QUIC 的传输控制不再依赖内核的拥塞控制算法，而实现在应用层上。意味着可以根据不同的业务场景，实现配置不同的拥塞控制算法参数，甚至同一业务的不同 QUIC 链接也可以使用不同的拥塞控制算法。

### 4. 连接迁移

当实际用户的网络发生变化时，从 WiFi 网络切换到 4G 网络时，用户地址发生变化，基于 TCP 的 HTTP 协议无法保持链接的存活；而 QUIC 基于链接的 CID 作为链接标识，仍然可以保证链接的存活和数据正常收发。

### QUIC 可以加速那些场景

* 动态请求（API 和信令传输场景）：降低动态交互耗时
* 短视频：提升首屏秒开率，降低卡顿率
* 图片文件下载：降低文件下载总耗时
* 直播：降低播放卡顿率，提升推流稳定性

