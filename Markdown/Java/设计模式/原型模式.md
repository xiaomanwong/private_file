



1. 什么是原型模式

   如果对象的创建成本比较大，而同一个类型的不同对象之间差别不大（大部分都相同），在这种情况下，如果可以利用对已有对象(原型)进行复制的方式，来创建对象，以达到节省创建时间的目的。这种基于原型来创建对象的方式就叫做原型模式。

2. 原型模式的两种实现方式

   原型模式有两种实现方式，**深拷贝** 和 **浅拷贝**，浅拷贝只会复制对象中基本数据类型数据和引用对象的内存地址，不会递归地复制引用对象，以及引用对象的引用对象。而深拷贝得到的是一份完完整整独立的对象。所以深拷贝比起浅拷贝来说，更加耗时，更加消耗空间。

   如果要拷贝的对象是不可变对象，浅拷贝共享不可变对象是没有问题的，但对于可变对象来说，浅拷贝得到的对象和原始对象会共享部分数据，就有可能出现数据被修改的风险，也就变得复杂多了。除非我们今天实



**浅拷贝**

```java
public class Demo {
  private HashMap<String, SearchResult> currentKeyWords = new HashMap();
  private long lastUpdateTime = -1;
  
  
  public void refresh () {
    // 原型模式，拷贝已有对象的数据，更新少量数据
    List<SearchResult> toBeUpdateSearchWords = getSearchWords(lastUpdateTime);
    long maxNewUpdateTime = lastUpdateTime;
    for(SearchResult result : toBeUpdateSearchWords) {
			if(result.getLastUpdateTime() > maxNewUpdateTime) {
        maxNewUpdateTime = result.getLastUpdateTime();
      }
      if(newKeyWords.containsKey(result.getKeyword())) {
        SearchResult old = newKeyWords.get(result.getKeyword());
        old.setCount(result.getCount());
        old.setLastUpdateTime(result.getLastUpdateTime());
      } else {
        newKeywords.put(result.getKeyword(), result);
      }
    }
    lastUpdateTime = maxNewUpateTime;
    currentKeywords = newKeywords;
  }
  
  private List<SerchResult> getSearchResult(long lastUpdateTime) {
    return null;
  }
}
```

